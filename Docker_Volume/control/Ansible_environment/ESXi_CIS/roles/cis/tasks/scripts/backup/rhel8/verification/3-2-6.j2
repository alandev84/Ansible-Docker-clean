#!/bin/sh

sysctl net.ipv4.icmp_ignore_bogus_error_responses | grep -E '^\s*net.ipv4.icmp_ignore_bogus_error_responses\s*=\s*1\s*$' \
&& \
[ `grep -E -s "^\s*net\.ipv4\.icmp_ignore_bogus_error_responses\s*=\s*0" /etc/sysctl.conf /etc/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /run/sysctl.d/*.conf | wc -l` -eq 0 ] \
|| \
(echo 'bogus ICMP responses settings are wrong' ; exit 1)
