#!/bin/bash

sysctl net.ipv4.conf.all.rp_filter | grep -E "^\s*net\.ipv4\.conf\.all\.rp_filter\s*=\s*1\s*$"  \
&& \
sysctl net.ipv4.conf.default.rp_filter | grep -E "^\s*net\.ipv4\.conf\.default\.rp_filter\s*=\s*1\s*$"  \
&& \
grep "net\.ipv4\.conf\.all\.rp_filter" /etc/sysctl.conf /etc/sysctl.d/* | grep -E "\s*net\.ipv4\.conf\.all\.rp_filter\s*=\s*1\s*$" \
&& \
grep "net\.ipv4\.conf\.default\.rp_filter" /etc/sysctl.conf /etc/sysctl.d/* | grep -E "\s*net\.ipv4\.conf\.default\.rp_filter\s*=\s*1\s*$" \
|| \
exit 1

#Run the following commands and verify output matches: 
# sysctl net.ipv4.conf.all.rp_filter Output Result: net.ipv4.conf.all.rp_filter = 1 
# sysctl net.ipv4.conf.default.rp_filter Output Result: net.ipv4.conf.default.rp_filter = 1 
# grep "net\.ipv4\.conf\.all\.rp_filter" /etc/sysctl.conf /etc/sysctl.d/* Output Result: net.ipv4.conf.all.rp_filter = 1 
# grep "net\.ipv4\.conf\.default\.rp_filter" /etc/sysctl.conf /etc/sysctl.d/* Output Result: net.ipv4.conf.default.rp_filter = 1
