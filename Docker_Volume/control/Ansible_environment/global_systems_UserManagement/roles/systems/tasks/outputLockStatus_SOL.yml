---
  - name: Initialisation [1/4] [Solaris]
    shell: "rm -rf {{ item.file_path_src_UserStatus }}"
    loop: "{{ collection }}"
    async: 60
    poll: 0

  # change /home/devops to something else
  - name: Initialisation [2/4] [Solaris]
    shell: "rm -rf /home/devops/UserStatus"
    async: 60
    poll: 0

  # change /home/devops to something else
  - name: Initialisation [3/4] [Solaris]
    shell: "rm -rf /home/devops/finalPW"
    async: 60
    poll: 0

  - name: Initialisation [4/4] [Solaris]
    become: false
    run_once: yes
    delegate_to: localhost
    shell: "rm -rf /Ansible_Event_Report/UserStatus_Report_SOL.log"

  - name: Pull Result [1/7] [Solaris]
    become: true
    shell: 'echo "-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-" >> {{ item.file_path_src_UserStatus }}'
    loop: "{{ collection }}"
    async: 60
    poll: 0

  - name: Pull Result [2/7] [Solaris]
    become: true
    shell: 'echo "HOSTNAME: {{ inventory_hostname }}" >> {{ item.file_path_src_UserStatus }}'  
    loop: "{{ collection }}"
    async: 60
    poll: 0

  - name: Pull Result [3/7] [Solaris]
    become: true
    shell: 'echo  "*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*" >> {{ item.file_path_src_UserStatus }}'
    loop: "{{ collection }}"
    async: 60
    poll: 0

  - name: Pull Result [4/7] [Solaris]
    become: true
    shell: 'echo "-------------------User Status-------------------" >> {{ item.file_path_src_UserStatus }}'
    loop: "{{ collection }}"
    async: 60
    poll: 0

  # change /home/devops to something else
  - name: Pull Result [5/7] [Solaris]
    become: true
    shell: "passwd -S {{ item.name }} >> /home/devops/UserStatus"
    loop: "{{ users }}"
    async: 60
    poll: 0
  # change /home/devops to something else
  - name: Pull Result [6/7] [Solaris]
    become: true
    shell: "cat /home/devops/UserStatus {{ item.file_path_src_UserStatus }} > /home/devops/finalPW"
    loop: "{{ collection }}"
    async: 60
    poll: 0

  - name: Pull Result [7/7] [Solaris]
    become: true
    shell: "mv /home/devops/finalPW {{ item.file_path_src_UserStatus }}"
    loop: "{{ collection }}"
    async: 60
    poll: 0

  # have to change the permission, try {{ owner }}
  - name: Extraction Processing [1/4] [Solaris]
    become: true
    ansible.builtin.shell: "chown devops:devops {{ item.file_path_src_UserStatus }}"
    loop: "{{ collection }}"
    async: 60
    poll: 0

  - name: Extraction Processing [2/4] [Solaris]
    fetch:
      src: "{{ item.file_path_src_UserStatus }}"
      dest: "{{ item.file_path_dest }}"
      flat: yes
    loop: "{{ collection }}"

  - name: Extraction Processing [3/4] [Solaris]
    become: false
    run_once: yes
    delegate_to: localhost
    shell: "cat {{ item.local_path }}*.txt > {{ item.local_path }}UserStatus_Report_SOL.log"
    loop: "{{ collection }}"
    async: 60
    poll: 0

  - name: Extraction Processing [4/4] [Solaris]
    become: false
    run_once: yes
    delegate_to: localhost
    shell: "rm -rf {{ item.local_path }}*.txt"
    loop: "{{ collection }}"
    async: 60
    poll: 0

  - name: Generate Report
    ansible.builtin.debug:
      msg: "Output Result from {{ ansible_hostname }} Merge to /Ansible_Event_Report/UserStatus_Report_SOL.log"