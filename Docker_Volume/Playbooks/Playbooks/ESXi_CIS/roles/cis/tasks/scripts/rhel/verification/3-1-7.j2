#!/bin/bash

sysctl net.ipv4.conf.all.accept_redirects | grep -E "^\s*net\.ipv4\.conf\.all\.accept_redirects\s*=\s*0\s*$"  \
&& \
sysctl net.ipv4.conf.default.accept_redirects | grep -E "^\s*net\.ipv4\.conf\.default\.accept_redirects\s*=\s*0\s*$" \
&& \
grep "net\.ipv4\.conf\.all\.accept_redirects" /etc/sysctl.conf /etc/sysctl.d/* | grep -E "\s*net\.ipv4\.conf\.all\.accept_redirects\s*=\s*0\s*$" \
&& \
grep "net\.ipv4\.conf\.default\.accept_redirects" /etc/sysctl.conf /etc/sysctl.d/* | grep -E "\s*net\.ipv4\.conf\.default\.accept_redirects\s*=\s*0\s*$" \
|| \
exit 1


#Run the following commands and verify output matches: 
# sysctl net.ipv4.conf.all.accept_redirects Output Result: net.ipv4.conf.all.accept_redirects = 0 
# sysctl net.ipv4.conf.default.accept_redirects Output Result: net.ipv4.conf.default.accept_redirects = 0 
# grep "net\.ipv4\.conf\.all\.accept_redirects" /etc/sysctl.conf /etc/sysctl.d/* Output Result: net.ipv4.conf.all.accept_redirects= 0 
# grep "net\.ipv4\.conf\.default\.accept_redirects" /etc/sysctl.conf /etc/sysctl.d/* Output Result: net.ipv4.conf.default.accept_redirects= 0 
#IF IPv6 is not disabled: Run the following commands and verify output matches: # sysctl net.ipv6.conf.all.accept_redirects Output Result: net.ipv6.conf.all.accept_redirects = 0 # sysctl net.ipv6.conf.default.accept_redirects Output Result: net.ipv6.conf.default.accept_redirects = 0 # grep "net\.ipv6\.conf\.all\.accept_redirects" /etc/sysctl.conf /etc/sysctl.d/* Output Result: net.ipv6.conf.all.accept_redirects= 0 # grep "net\.ipv6\.conf\.default\.accept_redirects" /etc/sysctl.conf /etc/sysctl.d/* Output Result: net.ipv6.conf.default.accept_redirects= 0
