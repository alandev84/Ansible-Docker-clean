#!/bin/bash

sysctl net.ipv4.conf.all.accept_source_route | grep -E "^\s*net\.ipv4\.conf\.all\.accept_source_route\s*=\s*0\s*$"  \
&& \
sysctl net.ipv4.conf.default.accept_source_route | grep -E "^\s*net\.ipv4\.conf\.default\.accept_source_route\s*=\s*0\s*$" \
&& \
grep "net\.ipv4\.conf\.all\.accept_source_route" /etc/sysctl.conf /etc/sysctl.d/* | grep -E "\s*net\.ipv4\.conf\.all\.accept_source_route\s*=\s*0\s*$" \
&& \
grep "net\.ipv4\.conf\.default\.accept_source_route" /etc/sysctl.conf /etc/sysctl.d/* | grep -E "\s*net\.ipv4\.conf\.default\.accept_source_route\s*=\s*0\s*$" \
|| \
exit 1

#Run the following commands and verify output matches: 
# sysctl net.ipv4.conf.all.accept_source_route Output Result: net.ipv4.conf.all.accept_source_route = 0 
# sysctl net.ipv4.conf.default.accept_source_route Output Result: net.ipv4.conf.default.accept_source_route = 0 
# grep "net\.ipv4\.conf\.all\.accept_source_route" /etc/sysctl.conf /etc/sysctl.d/* Output Result: net.ipv4.conf.all.accept_source_route= 0
# grep "net\.ipv4\.conf\.default\.accept_source_route" /etc/sysctl.conf /etc/sysctl.d/* Output Result: net.ipv4.conf.default.accept_source_route= 0 
#IF IPv6 is enabled: Run the following commands and verify output matches: # sysctl net.ipv6.conf.all.accept_source_route net.ipv6.conf.all.accept_source_route = 0 # sysctl net.ipv6.conf.default.accept_source_route net.ipv6.conf.default.accept_source_route = 0 # grep "net\.ipv6\.conf\.all\.accept_source_route" /etc/sysctl.conf /etc/sysctl.d/* net.ipv4.conf.all.accept_source_route= 0 # grep "net\.ipv6\.conf\.default\.accept_source_route" /etc/sysctl.conf /etc/sysctl.d/* net.ipv6.conf.default.accept_source_route= 0
