#!/bin/bash

sysctl net.ipv4.conf.all.secure_redirects | grep -E "^\s*net\.ipv4\.conf\.all\.secure_redirects\s*=\s*0\s*$"  \
&& \
sysctl net.ipv4.conf.default.secure_redirects | grep -E "^\s*net\.ipv4\.conf\.default\.secure_redirects\s*=\s*0\s*$" \
&& \
grep "net\.ipv4\.conf\.all\.secure_redirects" /etc/sysctl.conf /etc/sysctl.d/* | grep -E "\s*net\.ipv4\.conf\.all\.secure_redirects\s*=\s*0\s*$" \
&& \
grep "net\.ipv4\.conf\.default\.secure_redirects" /etc/sysctl.conf /etc/sysctl.d/* | grep -E "\s*net\.ipv4\.conf\.default\.secure_redirects\s*=\s*0\s*$" \
|| \
exit 1


#Run the following commands and verify output matches: 
# sysctl net.ipv4.conf.all.secure_redirects Output Result: net.ipv4.conf.all.secure_redirects = 0 
# sysctl net.ipv4.conf.default.secure_redirects Output Result: net.ipv4.conf.default.secure_redirects = 0 
# grep "net\.ipv4\.conf\.all\.secure_redirects" /etc/sysctl.conf /etc/sysctl.d/* Output Result: net.ipv4.conf.all.secure_redirects= 0 
# grep "net\.ipv4\.conf\.default\.secure_redirects" /etc/sysctl.conf /etc/sysctl.d/* Output Result: net.ipv4.conf.default.secure_redirects= 0

